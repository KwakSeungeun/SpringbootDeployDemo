steps:
  - id: 'build'
    name: 'gcr.io/cloud-builders/mvn'
    args: [
        'clean',
        'package',
        '-Dmaven.test.skip=true'
    ]
  - id: 'docker build'
    name: 'gcr.io/cloud-builders/docker'
    args: [ 'build', '-t', 'gcr.io/$PROJECT_ID/$COMMIT_SHA', '.' ]
  - id: 'docker image list'
    name: 'gcr.io/cloud-builders/docker'
    args: [ 'images']
  - id: 'publish'
    name: 'gcr.io/cloud-builders/docker'
    entrypoint: 'bash'
    args: ['-C', 'docker push gcr.io/$PROJECT_ID/$COMMIT_SHA:latest']

#  - name: 'gcr.io/$PROJECT_ID/$COMMIT_SHA' RUN SPRING PROJECT #Spring project image를 바로 실행시킴

timeout: 1600s